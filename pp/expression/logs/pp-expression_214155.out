1) load mtx file and rows and col names file
2) apply magic on the data
Calculating MAGIC...
  Running MAGIC on 22469 cells and 33691 genes.
  Calculating graph and diffusion operator...
    Calculating PCA...
    Calculated PCA in 8.70 seconds.
    Calculating KNN search...
    Calculated KNN search in 23.84 seconds.
    Calculating affinities...
    Calculated affinities in 24.03 seconds.
  Calculated graph and diffusion operator in 57.70 seconds.
  Running MAGIC with `solver='exact'` on 33691-dimensional data may take a long time. Consider denoising specific genes with `genes=<list-like>` or using `solver='approximate'`.
  Calculating imputation...
  Calculated imputation in 60.41 seconds.
Calculated MAGIC in 118.52 seconds.
/gpfs/radev/home/aa2793/.conda/envs/pytorch_brain_pp/lib/python3.8/site-packages/graphtools/graphs.py:290: RuntimeWarning: Detected zero distance between 16391 pairs of samples. Consider removing duplicates to avoid errors in downstream processing.
  warnings.warn(
/gpfs/radev/home/aa2793/.conda/envs/pytorch_brain_pp/lib/python3.8/site-packages/graphtools/base.py:554: RuntimeWarning: K should have a non-zero diagonal
  warnings.warn("K should have a non-zero diagonal", RuntimeWarning)
3) save magic output
4) filter the sf
5) save filter files
  File "pp02_compute_moments.py", line 30
    def apply moments(neuron_set_dfs):
              ^
SyntaxError: invalid syntax
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [05:01<4:06:00, 301.24s/it]  4%|▍         | 2/50 [05:33<1:54:29, 143.12s/it]  6%|▌         | 3/50 [06:08<1:13:31, 93.87s/it]   8%|▊         | 4/50 [07:10<1:02:06, 81.01s/it] 10%|█         | 5/50 [07:13<39:50, 53.13s/it]   12%|█▏        | 6/50 [07:24<28:24, 38.74s/it] 14%|█▍        | 7/50 [07:34<21:04, 29.41s/it] 16%|█▌        | 8/50 [08:18<23:39, 33.79s/it] 18%|█▊        | 9/50 [08:19<16:04, 23.53s/it] 20%|██        | 10/50 [08:26<12:25, 18.64s/it] 22%|██▏       | 11/50 [08:57<14:29, 22.30s/it] 24%|██▍       | 12/50 [08:57<09:53, 15.63s/it] 26%|██▌       | 13/50 [08:58<06:50, 11.10s/it] 28%|██▊       | 14/50 [08:59<04:47,  7.99s/it] 30%|███       | 15/50 [09:01<03:35,  6.16s/it] 32%|███▏      | 16/50 [09:03<02:51,  5.04s/it] 34%|███▍      | 17/50 [09:09<02:59,  5.45s/it] 36%|███▌      | 18/50 [09:12<02:27,  4.62s/it] 38%|███▊      | 19/50 [09:42<06:19, 12.24s/it] 40%|████      | 20/50 [09:46<04:51,  9.71s/it] 42%|████▏     | 21/50 [10:06<06:13, 12.88s/it] 44%|████▍     | 22/50 [10:12<05:02, 10.82s/it] 46%|████▌     | 23/50 [10:13<03:29,  7.75s/it] 48%|████▊     | 24/50 [10:20<03:19,  7.68s/it] 50%|█████     | 25/50 [10:35<04:02,  9.69s/it] 52%|█████▏    | 26/50 [10:35<02:44,  6.84s/it] 54%|█████▍    | 27/50 [10:37<02:01,  5.27s/it] 56%|█████▌    | 28/50 [10:38<01:31,  4.17s/it] 58%|█████▊    | 29/50 [10:42<01:25,  4.09s/it] 60%|██████    | 30/50 [10:51<01:50,  5.51s/it] 62%|██████▏   | 31/50 [10:59<01:57,  6.21s/it] 64%|██████▍   | 32/50 [10:59<01:21,  4.51s/it] 66%|██████▌   | 33/50 [11:17<02:24,  8.49s/it] 68%|██████▊   | 34/50 [11:26<02:18,  8.66s/it] 70%|███████   | 35/50 [11:55<03:39, 14.61s/it] 72%|███████▏  | 36/50 [12:16<03:51, 16.50s/it] 74%|███████▍  | 37/50 [12:17<02:34, 11.91s/it] 76%|███████▌  | 38/50 [12:23<02:01, 10.09s/it] 78%|███████▊  | 39/50 [12:37<02:05, 11.40s/it] 80%|████████  | 40/50 [12:42<01:34,  9.49s/it] 82%|████████▏ | 41/50 [12:45<01:07,  7.46s/it] 84%|████████▍ | 42/50 [12:55<01:06,  8.28s/it] 86%|████████▌ | 43/50 [13:06<01:03,  9.06s/it] 88%|████████▊ | 44/50 [13:47<01:51, 18.59s/it] 90%|█████████ | 45/50 [14:22<01:57, 23.59s/it] 92%|█████████▏| 46/50 [14:50<01:39, 24.83s/it] 94%|█████████▍| 47/50 [15:14<01:14, 24.79s/it] 96%|█████████▌| 48/50 [15:30<00:44, 22.17s/it] 98%|█████████▊| 49/50 [15:40<00:18, 18.32s/it]100%|██████████| 50/50 [15:45<00:00, 14.47s/it]100%|██████████| 50/50 [15:45<00:00, 18.91s/it]Processing group: PHA
MI matrix for neuron 'PHA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PHA.csv
Processing group: PVM
MI matrix for neuron 'PVM' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PVM.csv
Processing group: PVC
MI matrix for neuron 'PVC' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PVC.csv
Processing group: PVD
MI matrix for neuron 'PVD' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PVD.csv
Processing group: LUA
MI matrix for neuron 'LUA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_LUA.csv
Processing group: ASEL
MI matrix for neuron 'ASEL' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ASEL.csv
Processing group: DVC
MI matrix for neuron 'DVC' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_DVC.csv
Processing group: AFD
MI matrix for neuron 'AFD' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AFD.csv
Processing group: AVH
MI matrix for neuron 'AVH' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVH.csv
Processing group: IL1
MI matrix for neuron 'IL1' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_IL1.csv
Processing group: AIY
MI matrix for neuron 'AIY' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AIY.csv
Processing group: DVB
MI matrix for neuron 'DVB' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_DVB.csv
Processing group: HSN
MI matrix for neuron 'HSN' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_HSN.csv
Processing group: ASER
MI matrix for neuron 'ASER' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ASER.csv
Processing group: OLQ
MI matrix for neuron 'OLQ' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_OLQ.csv
Processing group: I5
MI matrix for neuron 'I5' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_I5.csv
Processing group: AVM
MI matrix for neuron 'AVM' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVM.csv
Processing group: PVP
MI matrix for neuron 'PVP' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PVP.csv
Processing group: CEP
MI matrix for neuron 'CEP' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_CEP.csv
Processing group: PVQ
MI matrix for neuron 'PVQ' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_PVQ.csv
Processing group: BAG
MI matrix for neuron 'BAG' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_BAG.csv
Processing group: AVL
MI matrix for neuron 'AVL' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVL.csv
Processing group: AWB
MI matrix for neuron 'AWB' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AWB.csv
Processing group: AIM
MI matrix for neuron 'AIM' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AIM.csv
Processing group: AIN
MI matrix for neuron 'AIN' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AIN.csv
Processing group: AVG
MI matrix for neuron 'AVG' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVG.csv
Processing group: RME
MI matrix for neuron 'RME' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RME.csv
Processing group: AVA
MI matrix for neuron 'AVA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVA.csv
Processing group: ASI
MI matrix for neuron 'ASI' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ASI.csv
Processing group: AVK
MI matrix for neuron 'AVK' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVK.csv
Processing group: RMD
MI matrix for neuron 'RMD' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RMD.csv
Processing group: AWA
MI matrix for neuron 'AWA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AWA.csv
Processing group: ASK
MI matrix for neuron 'ASK' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ASK.csv
Processing group: RIS
MI matrix for neuron 'RIS' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RIS.csv
Processing group: NSM
MI matrix for neuron 'NSM' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_NSM.csv
Processing group: ADL
MI matrix for neuron 'ADL' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ADL.csv
Processing group: AVE
MI matrix for neuron 'AVE' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_AVE.csv
Processing group: RIM
MI matrix for neuron 'RIM' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RIM.csv
Processing group: RIC
MI matrix for neuron 'RIC' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RIC.csv
Processing group: IL2
MI matrix for neuron 'IL2' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_IL2.csv
Processing group: DA
MI matrix for neuron 'DA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_DA.csv
Processing group: SMB
MI matrix for neuron 'SMB' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_SMB.csv
Processing group: VB
MI matrix for neuron 'VB' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_VB.csv
Processing group: SMD
MI matrix for neuron 'SMD' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_SMD.csv
Processing group: VC
MI matrix for neuron 'VC' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_VC.csv
Processing group: SIA
MI matrix for neuron 'SIA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_SIA.csv
Processing group: RIA
MI matrix for neuron 'RIA' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_RIA.csv
Processing group: ASG
MI matrix for neuron 'ASG' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_ASG.csv
Processing group: OLL
MI matrix for neuron 'OLL' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_OLL.csv
Processing group: CAN
MI matrix for neuron 'CAN' saved to /gpfs/radev/home/aa2793/project/cellnn/dataset/Alternative-Splicing/expression_dataset/pp03_graphs//mi_matrix_CAN.csv

Processing Neurons:   0%|          | 0/50 [00:00<?, ?it/s]> /gpfs/radev/project/lafferty/aa2793/cellnn/cellsplice.net/pp/expression/pp04_get_scattering_coeffs.py(122)main()
-> label = file.split('_')[-1].split('.')[0]
(Pdb) Processing Neurons:   0%|          | 0/50 [00:00<?, ?it/s]

Traceback (most recent call last):
  File "pp04_get_scattering_coeffs.py", line 143, in <module>
    main()
  File "pp04_get_scattering_coeffs.py", line 122, in main
    label = file.split('_')[-1].split('.')[0]
  File "pp04_get_scattering_coeffs.py", line 122, in main
    label = file.split('_')[-1].split('.')[0]
  File "/gpfs/radev/home/aa2793/.conda/envs/pytorch_brain_pp/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gpfs/radev/home/aa2793/.conda/envs/pytorch_brain_pp/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
